<?php/**************************************************************************** LivSNS 0.1* (C)2004-2010 HOGE Software.** $Id: convent.php 17960 2013-02-26 05:53:39Z yaojian $***************************************************************************/define('WITHOUT_DB', true);require_once './global.php';include_once ROOT_PATH . 'lib/class/curl.class.php';include_once ROOT_PATH . 'lib/class/auth.class.php';define('MOD_UNIQUEID', 'officeConvert'); //模块标识class officeConvertApi extends appCommonFrm{		public function __construct()	{		parent::__construct();	}	public function __destruct()	{		parent::__destruct();	}		/**	 * 转换word文档	 */	public function convert()	{		$app_id = isset($this->input['custom_appid']) ? trim($this->input['custom_appid']) : '';		$app_key = isset($this->input['custom_appkey']) ? trim($this->input['custom_appkey']) : '';		if (empty($app_id) || empty($app_key)) $this->errorOutput(PARAM_WRONG);		//先验证是否有权限		$auth = new Auth();		$auth_info = $auth->getAccessToken($app_id, $app_key);		if (!$auth_info) $this->errorOutput(NO_AUTH);		//处理上传的word文档		$gGlobalConfig['officeconvert'] = array(			'host' => '10.0.1.59:8080',			'dir' => 'officeConverter/'		);		$curl = new curl($gGlobalConfig['officeconvert']['host'], $gGlobalConfig['officeconvert']['dir']);		$curl->setSubmitType('post');		$curl->setReturnFormat('str');		$curl->initPostData();		$curl->addFile($_FILES);		$curl->addRequestData('custom_appid', $app_id);		$curl->addRequestData('custom_appkey', $app_key);		$result = $curl->request('converter');		if (!$result) $this->errorOutput(FAIL_OP);		$this->addItem($result);		$this->output();	}}$out = new officeConvertApi();$action = $_INPUT['a'];if (!method_exists($out, $action)){	$action = 'convert';}$out->$action();?>