<?phprequire_once './global.php';require_once CUR_CONF_PATH.'lib/pic.class.php';define('MOD_UNIQUEID','webapp_pic');//模块标识class webapppicApi extends adminReadBase{	private $pic;	public function __construct()	{		parent::__construct();		$this->pic = new picClass();	}	public function __destruct()	{		parent::__destruct();	}	public function index()	{			}	public function show()	{		$offset = $this->input['offset']?intval(urldecode($this->input['offset'])):0;		$count = $this->input['count']?intval(urldecode($this->input['count'])):10;		$limit = " limit {$offset}, {$count}";		$condition = $this->get_condition();		$ret = $this->pic->show($condition,' ORDER BY type asc,id asc ',$limit);		if (!empty($ret))		{			foreach ($ret as $key=>$val)			{				$this->addItem($val);			}		}		$this->output();			}	public function get_condition()	{		$condition ='';		if($this->input['k'])		{			$condition .= ' AND title LIKE "%'.trim(urldecode($this->input['k'])).'%"';		}		return $condition;	}	public function count()	{		$ret = $this->pic->count($this->get_condition());		echo json_encode($ret);	}	public function detail()	{		if (!$this->input['id'])		{			$this->errorOutput(OBJECT_NULL);		}		$id = intval($this->input['id']);		$ret = $this->pic->detail($id);		$this->addItem($ret);		$this->output();	}	public function get_many_material()	{		$offset = intval($this->input['start'])?intval($this->input['start']):0;		$count = intval($this->input['num'])?intval($this->input['num']):100;		$limit = "  LIMIT {$offset}, {$count}";		$condition = $this->get_condition();		$order = " ORDER BY id desc ";		$sql = "SELECT * FROM ".DB_PREFIX."webapp_material WHERE 1 ".$condition.$order.$limit;		$query = $this->db->query($sql);		$k = array();		while ($row = $this->db->fetch_array($query))		{			$pic = array();			if ($row['user_img'])			{				$pic = unserialize($row['user_img']);			}else {				$pic = unserialize($row['system_img']);			}			$row['pic'] = $pic;			unset($row['user_img']);			unset($row['system_img']);			$k['material'][$row['id']] = $row;			}		$this->addItem($k);		$this->output();	}		public function get_apps()	{		$data = $this->pic->get_apps();		$this->addItem($data);		$this->output();	}	}$ouput = new webapppicApi();if(!method_exists($ouput, $_INPUT['a'])){	$action = 'show';}else {	$action = $_INPUT['a'];}$ouput->$action();