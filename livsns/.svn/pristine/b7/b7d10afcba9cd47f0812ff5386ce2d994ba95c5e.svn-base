<?phprequire('global.php');define(MOD_UNIQUEID,'webapp_rank');class webapprankUpdate extends adminUpdateBase{	function __construct()	{		parent::__construct();	}	function __destruct()	{		parent::__destruct();	}		public function sort()	{			}	public function publish()	{			}			function create()	{		if(!trim($this->input['title']))		{			$this->errorOutput('名称不能为空');		}		$info = array(			'title' 	=> addslashes($this->input['title']),			'start_time'=> $this->input['start_time'] ? strtotime($this->input['start_time']) : '',			'duration'  => $this->input['duration'],			'limit_num' => $this->input['limit_num'] ? intval($this->input['limit_num']) : '30',			'ranktype'  => $this->input['ranktype'],			'sort_type'  => $this->input['sort_type'],			'user_id'   => $this->user['user_id'],			'user_name' => $this->user['user_name'],			'appid'   => $this->user['appid'],			'appname' => $this->user['appname'],			'ip' => $this->user['ip'],			'create_time' => TIMENOW,			'update_time' => TIMENOW,			'type'        => implode(',', $this->input['type']),		);		$sql = "INSERT INTO ".DB_PREFIX."webapp_rank SET ";		$space = '';		foreach($info as $key => $value)		{			$sql .= $space . $key ."='".$value."'";			$space = ',';		}		$this->db->query($sql);		$this->addItem('true');		$this->output();	}		function update()	{		$id = intval($this->input['id']);		if(!$id)		{			$this->errorOutput(OBJECT_NULL);		}		if(!trim($this->input['title']))		{			$this->errorOutput('名称不能为空');		}		$info = array(			'title' 	  => addslashes($this->input['title']),			'start_time'  => $this->input['start_time'] ? strtotime($this->input['start_time']) : '', 			'duration'    => $this->input['duration'],			'limit_num'   => $this->input['limit_num'] ? intval($this->input['limit_num']) : '30',			'ranktype'  => $this->input['ranktype'],			'sort_type'  => $this->input['sort_type'],			'update_time' => TIMENOW,			'user_id'   => $this->user['user_id'],			'user_name' => $this->user['user_name'],			'appid'   => $this->user['appid'],			'appname' => $this->user['appname'],			'ip' => $this->user['ip'],			'type'        => implode(',', $this->input['type']),		);			$sql = "UPDATE " . DB_PREFIX . "webapp_rank SET ";		$space = '';		foreach($info as $key => $value)		{			$sql .= $space . $key . "='".$value."'";			$space = ',';			}		$sql .= " WHERE id = " . $id;			$this->db->query($sql);		if($this->db->affected_rows() > 0 )		{			$data = array(				'update_time' => TIMENOW,			);			$sql = "UPDATE " . DB_PREFIX . "webapp_rank SET ";			$space = '';			foreach($data as $key => $value)			{					$sql .= $space . $key . "='".$value."'";					$space = ',';				}			$sql .= " WHERE id = " . $id;				$this->db->query($sql);		}		$this->addItem($info);		$this->output();	}		function delete()	{		$id = hg_filter_ids(urldecode($this->input['id']));		if(!$id)		{			$this->errorOutput(OBJECT_NULL);		}		$sql = "DELETE FROM ".DB_PREFIX."webapp_rank WHERE id IN(" . $id . ")";		$this->db->query($sql);		$this->addItem($id);		$this->output();	}		function audit()	{			}		function unknow()	{		$this->errorOutput("调用方法错误");	}}$out = new webapprankUpdate();$action = $_INPUT['a'];if(!method_exists($out,$action)){	$action = 'unknow';}$out->$action();?>