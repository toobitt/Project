<?php/**************************************************************************** LivSNS 0.1* (C)2004-2012 HOGE Software.** $Id: photo.php 2012-10-09 10:58:59Z yaojian $***************************************************************************/require './global.php';require './lib/photo.class.php';class photoApi extends BaseFrm{	private $photo;		public function __construct()	{		parent::__construct();		$this->photo = new photo();	}		public function __destruct()	{		parent::__destruct();	}		//获取所有相册信息	public function show()	{		$offset = isset($this->input['offset']) ? intval($this->input['offset']) : 0;		$count = isset($this->input['count']) ? intval($this->input['count']) : 20;		$user_id = isset($this->input['uid']) ? intval($this->input['uid']) : -1;		$condition = array();		if ($user_id > 0)		{			$condition['user_id'] = $user_id;		}		$albums_info = $this->photo->show($offset, $count, $condition);		$this->setXmlNode('albums_info' , 'albums');		foreach($albums_info as $albums)		{			$this->addItem($albums);		}		$this->output();	}		//获取相册总数	public function count()	{		$user_id = isset($this->input['uid']) ? intval($this->input['uid']) : -1;		$condition = array();		if ($user_id > 0)		{			$condition['user_id'] = $user_id;		}		$info = $this->photo->count($condition);		echo json_encode($info);	}		//获取单个相册信息	public function detail()	{		$albums_id = isset($this->input['albums_id']) ? intval($this->input['albums_id']) : -1;		$user_id = isset($this->input['uid']) ? intval($this->input['uid']) : -1;		$offset = isset($this->input['offset']) ? intval($this->input['offset']) : 0;		$count = isset($this->input['count']) ? intval($this->input['count']) : 20;		if ($albums_id < 0 || $user_id < 0) $this->errorOutput(PARAM_WRONG);		$albums_info = $this->photo->detail($albums_id, $user_id);		if ($albums_info)		{			$albums_info['photos'] = $this->photo->get_photo($albums_id, $user_id, $offset, $count);		}		$this->addItem($albums_info);		$this->output();	}}$out = new photoApi();$action = $_INPUT['a'];if (!method_exists($out, $action)){	$action = 'show';}$out->$action();